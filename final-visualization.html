<!DOCTYPE html>
<meta charset="utf-8">

<style>
#boroughs {
  /*stroke: black;*/
	/*stroke-width: 1px;*/
	/*fill: transparent;*/
	fill: #eee;
    stroke: gray;
    stroke-width:1px;
    display:block;
}
.location {
    fill: blue;
    stroke: black;
    stroke-width:1px;
}
</style>

<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>

<body>

<script>

var width = 960,
   height = 960;

var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height);

    var layer1 = svg.append('g');
    var layer2 = svg.append('g');

    d3.json("nyc.json", function(error, nyb) {

        var proj = d3.geo.mercator()
                .center([-73.94, 40.70])
                .scale(80000)
                .translate([(width) / 2, (height)/2]);

        var path = d3.geo.path()
                .projection(proj);

        layer1
                .attr("id", "boroughs")
                .selectAll(".state")
                .data(nyb.features)
                .enter().append("path")
                .attr("class", function(d){ return d.properties.name; })
                .attr("d", path);

    });

    d3.json("geojson/Trustees of Columbia.geojson", function(error, columbia) {

        var proj = d3.geo.mercator()
                .center([-73.94, 40.70])
                .scale(80000)
                .translate([(width) / 2, (height)/2]);

        var path = d3.geo.path()
                .projection(proj);

        layer2
                .attr("id", "locations")
                .selectAll(".state")
                .data(columbia.features)
                .enter().append("circle")
                .attr("class", "location")
                .attr("r", "4px")
                .attr("cx", function(d) { return proj(d['geometry']['coordinates'])[0]; })
                .attr("cy", function(d) { return proj(d['geometry']['coordinates'])[1]; })
                .attr("d", path)
                .each(pulse);

		function pulse() {
            var circle = svg.select(".location");
            console.log(circle);
            (function repeat() {
                circle = circle.transition()
                        .duration(2000)
                        .attr("stroke-width", 20)
                        .attr("r", 10)
                        .transition()
                        .duration(2000)
                        .attr('stroke-width', 0.5)
                        .attr("r", 200)
                        .ease('sine')
                        .each("end", repeat);
            })();
        }

    });
//    var geoPath = d3.geo.path().projection(proj);

</script>
</body>